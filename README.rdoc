
= atoneの試練 etaku

atoneの試練にて、ポーカーの役判定アプリを作りました。

具体的には、WebAppとAPIの２つと、それをチェックするテストコードを書きました。

== 環境

* ruby 2.4.7p357 (2019-08-28 revision 67796) [-darwin21]
* Rails 4.2.11.3

== 使い方

bundle exec rails s でサーバーを起動します。
ポートは+3000+、IPは<tt>localhost(127.0.0.1)</tt>です。

==== Webアプリケーション

①入力フォームに、以下のように5枚のカードを入力します。

<tt>S4 C6 D12 S1 H2</tt>
* 半角のスート（SHDC）とナンバー（1~13）を用いて、カードごとに半角スペースを開けてください。
* ジョーカーはありません。また、11, 12, 13 を J, Q, K で代用することはできません。

②「調べる」ボタンを押下すると、以下のような結果が表示されます。
* 入力内容にエラーがない場合、役の名前が表示されます。
* 入力内容にエラーがある場合、それに対応するメッセージが表示されます。

==== API

①入力データとして、以下のようなカード5枚組の⽂字列配列を含むJSONを⼊⼒します。

    "cards": [
        "S3 H4 D4 C2 S10",
        "C10 C11 C13 C1 C12",
        "F2 v10 S84 s6 Cあ",
    ]

* 入力可能なカードは、Webアプリケーションと同様です。
* APIのエンドポイントは、+/api/v1/poker+ です。
* HTTP/POST形式でリクエストしてください。

②出力データとして、以下のような結果が返されます。

    "results": [
        {
            "cards": "S3 H4 D4 C2 S10",
            "hand": "ワンペア",
            "best": false
        },
        {
            "cards": "C10 C11 C13 C1 C12",
            "hand": "ストレートフラッシュ",
            "best": true
        }
    ],
    "errors": [
        {
            "cards": "F2 v10 S84 s6 Cあ",
            "msg": [
                "1番目のカード指定文字が不正です。(F2)",
                "2番目のカード指定文字が不正です。(v10)",
                "3番目のカード指定文字が不正です。(S84)",
                "4番目のカード指定文字が不正です。(s6)",
                "5番目のカード指定文字が不正です。(Cあ)"
            ]
        }
    ]

* 入力内容にエラーがない場合、⼊⼒したカードとポーカーの役の名前、及びそれらの中で最も強い役を返します。
* 入力内容にエラーがある場合、それに対応するメッセージが表示されます。

==== RSpec

* テストにはRSpecを用いています。
* <tt>bundle exec rspec</tt> でテストが実行されます。